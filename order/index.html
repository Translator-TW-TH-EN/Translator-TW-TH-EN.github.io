
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>translator-tw-th-en</title>
    <!-- 載入資料 -->
    <script src="../data/common.js"></script>
    <script src="../data/loginCheck.js"></script>
    <script src="../data/data.js"></script>
    <script src="../data/loader.js" loading-on="true"></script>
    <link rel="stylesheet" type="text/css" href="../data/styles.css">
</head>

<body>

    <header>
        <!-- 這裡會自動填入登入之帳號 -->
    </header>


    <div class="container" id="container">
        <!-- 這裡會自動填入放在雲端 orderData -->
    </div>

    <div class="container-details" id="foodDetails">
        <div class="details-content">
            <span class="close-btn" onclick="hideDetails()">&times;</span>
            <img src="" alt="" id="ladyImg">
            <div>
                <h2 id="ladyName"></h2>
                <p id="ladyDescription"></p>
            </div>
        </div>
    </div>

    <footer>
        <a href="#" onclick="logOut()">登出</a>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', async function () {
            // 若無登入過則不執行
            if (!getCookie("phone")) return;
            // 創建全部的 orderData 資料
            var orderDatas = (await sendRequest("getOrderData")).data;
            var containerTempHTML = ""
            orderDatas.forEach(function (orderData) {
                var name = orderData[0];
                var imageUrl = orderData[1];
                var description = orderData[2];

                var containerItem = document.createElement('div');
                containerItem.style.display = 'flex';
                containerItem.classList.add('container-item', 'container-choose');
                containerItem.addEventListener('click', function (event) {
                    showDetails(name, description, imageUrl);
                });

                var img = document.createElement('img');
                img.src = imageUrl;
                img.alt = name;

                var textContainer = document.createElement('div');

                var h3 = document.createElement('h3');
                h3.textContent = name;

                var p = document.createElement('p');
                p.textContent = description;

                textContainer.appendChild(h3);
                textContainer.appendChild(p);
                containerItem.appendChild(img);
                containerItem.appendChild(textContainer);
                document.getElementById('container').appendChild(containerItem);
            });
            document.getElementById('loader').style.display = 'none';
        });

        function showDetails(name, description, imageUrl) {
            document.getElementById('ladyImg').src = imageUrl;
            document.getElementById('ladyImg').alt = name;
            document.getElementById('ladyName').innerText = name;
            document.getElementById('ladyDescription').innerText = description;
            document.querySelector('.container-details').style.display = 'flex';
        }

        function hideDetails() {
            document.querySelector('.container-details').style.display = 'none';
        }

        function logOut() {
            var pastDate = new Date(0);
            document.cookie = "phone=; expires=" + pastDate.toUTCString() + "; path=/";
            window.location.href = "/login";
        }
    </script>
</body>

</html>